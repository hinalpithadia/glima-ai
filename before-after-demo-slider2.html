<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .video-container {
            margin: 2rem;
            max-height: 300px;
        }

        img {
            display: block;
            max-width: 100%;
        }

        main {
            display: grid;
            place-items: center;
            /* min-height: 100vh; */
        }

        .container {
            display: grid;
            place-content: center;
            position: relative;
            overflow: hidden;
            border-radius: 1rem;
            --position: 50%;
            --transition: all 5s ease;
        }

        .image-container {
            max-width: 225px;
            height: 238px;
            /* max-height: 90vh; */
            /* aspect-ratio: 1/1; */
        }

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: left;
        }

        .image-before {
            position: absolute;
            /* object-fit: cover; */
            inset: 0;
            width: var(--position);

        }

        .image-after {
            object-fit: cover;
        }
        video{
            object-fit: cover; /* This provides the "cover" effect */
  object-position: center;
        }
        .slider {
            position: absolute;
            inset: 0;
            cursor: pointer;
            opacity: 0;
            width: 100%;
            height: 100%;
        }

        .slider:focus-visible~.slider-button {
            outline: 5px solid black;
            outline-offset: 3px;
        }

        .slider-line {
            position: absolute;
            inset: 0;
            width: .2rem;
            height: 100%;
            background-color: #fff;
            left: var(--position);
            transform: translateX(-50%);
            pointer-events: none;
        }

        .slider-badge {
            position: absolute;
            top: 10%;
            padding: 2px 5px;
            font-size: 10px;
            border-radius: 2px;
            font-weight: 500;
            background: #FFFFFF66;
            backdrop-filter: blur(4px)
        }

        .before-badge {
            left: var(--position);
            transform: translateX(calc(-100% - 4px));
        }

        .after-badge {
            left: var(--position);
            transform: translateX(4px);
        }

        .slider-button {
            position: absolute;
            background-color: #fff;
            color: black;
            padding: .5rem;
            border-radius: 100vw;
            display: grid;
            place-items: center;
            top: 50%;
            left: var(--position);
            transform: translate(-50%, -50%);
            pointer-events: none;
            /* z-index: 100; */
        }
    </style>
</head>

<body>
    <main>
        <div class="container">
            <div class="image-container">
                <img class="image-before slider-image" src="assets/images/dashboard-home/cloth-changer-img1.png" alt="color photo" />
                <img class="image-after slider-image" src="assets/images/dashboard-home/cloth-changer-img2.png" alt="black and white" />
            </div>
            <input type="range" min="0" max="100" value="50" aria-label="Percentage of before photo shown"
                class="slider" />
            <div class="slider-line" aria-hidden="true"></div>
            <div class="slider-badge before-badge">Before</div>
            <div class="slider-badge after-badge">After</div>
        </div>
         <div class="container">
            <div class="image-container">
                <video
      class="media media-after"
      src="assets/images/dashboard-home/video-style-change/video-style-change-img1.mp4"
      muted
      loop
      playsinline
      preload="metadata"
    ></video>

    <!-- BEFORE (image or video) -->
    <video
      class="media media-before"
      src="assets/images/dashboard-home/video-style-change/video-style-change-img2.mp4"
      muted
      loop
      playsinline
      preload="metadata"
    ></video>
            </div>
            <input type="range" min="0" max="100" value="50" aria-label="Percentage of before photo shown"
                class="slider" />
            <div class="slider-line" aria-hidden="true"></div>
            <div class="slider-badge before-badge">Before</div>
            <div class="slider-badge after-badge">After</div>
        </div>
    </main>
    <script>
        const container = document.querySelector('.container');
        const slider = document.querySelector('.slider');

        container.style.setProperty('--position', '50%');
        slider.value = 50;

        slider.addEventListener('input', (e) => {
            const val = Number(e.target.value);
            container.style.setProperty('--position', `${val}%`);
        });

        let autoEnabled = false;
        let animationFrameId = null;
        let lastTime = null;
        let hoverTimer = null;

        const cycleDuration = 7000;

        function getPositionFromTime(t) {
            const value = Math.sin(t * 2 * Math.PI) * 50 + 50;
            return value;
        }

        function animate(timestamp) {
            if (!autoEnabled) return;

            if (lastTime === null) lastTime = timestamp;
            const elapsed = timestamp - lastTime;

            const t = (elapsed % cycleDuration) / cycleDuration;
            const pos = getPositionFromTime(t);

            container.style.setProperty('--position', `${pos}%`);
            slider.value = pos;

            animationFrameId = requestAnimationFrame(animate);
        }

        function startAuto() {
            if (autoEnabled) return;
            autoEnabled = true;
            lastTime = null;
            cancelAnimationFrame(animationFrameId);
            animationFrameId = requestAnimationFrame(animate);
        }

        function stopAuto() {
            autoEnabled = false;
            cancelAnimationFrame(animationFrameId);
        }

        function snapBackToCenter() {
            stopAuto();
            container.style.transition = 'all 0.6s ease';
            container.style.setProperty('--position', '50%');
            slider.value = 50;

            setTimeout(() => {
                container.style.transition = 'none';
            }, 900);
        }

        container.addEventListener('mouseenter', () => {
            container.style.transition = 'none';
            clearTimeout(hoverTimer);
            hoverTimer = setTimeout(() => {
                startAuto();
            }, 1000);
        });

        container.addEventListener('mouseleave', () => {
            clearTimeout(hoverTimer);
            snapBackToCenter();
        });
    </script>
</body>

</html>